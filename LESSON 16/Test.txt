--1

SELECT ProductSubcategoryID, MIN (Weight)
FROM [Production].[Product]
GROUP BY ProductSubcategoryID
HAVING MIN (Weight)>150

--2
SELECT Name,StandardCost--1 
FROM [Production].[Product]
WHERE StandardCost =(SELECT MAX ( StandardCost) FROM [Production].[Product])

SELECT TOP 1 WITH TIES Name,StandardCost--2
FROM [Production].[Product]
ORDER BY StandardCost DESC
  
  
 SELECT Name,StandardCost--3 
FROM (SELECT  Name,StandardCost, RANK() OVER(ORDER BY StandardCost DESC) AS RNK
FROM[Production].[Product]) T
WHERE RNK=1


 SELECT Name,StandardCost--4
FROM (SELECT  Name,StandardCost, MAX(StandardCost) OVER() AS max_cost
FROM[Production].[Product]) T
WHERE StandardCost= max_cost

--3
SELECT Name, Registration_Number
FROM DimCustomers 
EXCEPT
SELECT Name, Registration_Number
FROM FctOrders f JOIN DimCustomers c ON c.ID_Customer = f. ID_Customer
WHERE RentDate > DATEADD(YEAR, -1, GETDATE())

--4 
SELECT Full_Name, COUNT (1) as CNT
FROM DimEmployees emp LEFT JOIN FctMaintenance m ON emp.EmployeeNumber=m.EmployeeNumber
WHERE Start_Date> DATEADD(YEAR, -5, GETDATE()) 
GROUP BY Full_Name

--5

SELECT n.Category, COUNT (1) as unread notif
FROM Notifications n JOIN Users u ON   n.user_id=u.user_id
WHERE u. email='alex@gmail.com' and n.is read IS False
GROUP BY n.Category
HAVING COUNT (1)>50
